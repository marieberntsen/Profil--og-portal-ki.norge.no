---
import Layout from '../../components/layout/Layout.astro';
import BlocksRenderer from '../../components/shared/BlocksRenderer.astro';
import { Heading, Paragraph, Button, Link } from '@digdir/designsystemet-react';
import { getSide } from '../../lib/strapi';

// Check for preview mode
const isPreview = Astro.url.searchParams.has('preview') || Astro.cookies.has('preview');

// Fetch page content from Strapi
let page = null;
try {
  page = await getSide('sandkasse', { preview: isPreview });
} catch (error) {
  console.error('Failed to fetch sandkasse page:', error);
}

const title = page?.tittel || 'Sandkasse';
const seoDescription = page?.seoBeskrivelse || '';
---

<Layout title={title} description={seoDescription}>
  <div class="page-container">
    {page?.innhold ? (
      <>
        <header class="page-header">
          <Heading level={1} size="2xlarge">{page.tittel}</Heading>
        </header>
        <BlocksRenderer blocks={page.innhold} class="page-content" />
      </>
    ) : (
      <div class="not-found">
        <Heading level={1} size="2xlarge">Siden er ikke tilgjengelig</Heading>
        <Paragraph>
          Denne siden er ikke publisert ennå. Vennligst prøv igjen senere.
        </Paragraph>
        <Link href="/">Gå til forsiden</Link>
      </div>
    )}
  </div>
</Layout>

<style>
  .page-container {
    max-width: 800px;
    margin: 0 auto;
    padding: var(--ds-size-8) var(--ds-size-4);
  }

  .page-header {
    margin-bottom: var(--ds-size-6);
  }

  .page-header :global(h1) {
    margin: 0;
  }

  .page-content {
    margin-bottom: var(--ds-size-8);
  }

  .not-found {
    text-align: center;
    padding: var(--ds-size-12) var(--ds-size-4);
  }

  .not-found :global(h1) {
    margin: 0 0 var(--ds-size-4);
  }

  .not-found :global(p) {
    margin: 0 0 var(--ds-size-6);
    color: var(--ds-color-neutral-text-subtle);
  }
</style>
